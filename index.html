<!DOCTYPE html>
<html>

<head>
  <!-- Basic -->
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <!-- Mobile Metas -->
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
  <!-- Site Metas -->
  <meta name="keywords" content="" />
  <meta name="description" content="" />
  <meta name="author" content="" />

  <title>¿CNN?</title>

  <!-- slider stylesheet -->
  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/assets/owl.carousel.min.css" />

  <!-- bootstrap core css -->
  <link rel="stylesheet" type="text/css" href="css/bootstrap.css" />

  <!-- fonts style -->
  <link href="https://fonts.googleapis.com/css?family=Poppins:400,600,700&display=swap" rel="stylesheet">
  <!-- Custom styles for this template -->
  <link href="css/style.css" rel="stylesheet" />
  <!-- responsive style -->
  <link href="css/responsive.css" rel="stylesheet" />
</head>

<body class="sub_page">
  <div class="hero_area">
    <!-- header section strats -->
    <header class="header_section">
      <div class="container-fluid">
        <nav class="navbar navbar-expand-lg custom_nav-container ">
          <a class="navbar-brand" href="#">
            <span>
              Kernel
            </span>
          </a>
          <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
          </button>

          
        </nav>
      </div>
    </header>
    <!-- end header section -->
  </div>

  <!-- Us section -->

  <section class="us_section layout_padding">
    <div class="container">
      <div class="heading_container">
        <h2>
          Procesamiento de Imágenes
        </h2>
      </div>

      <div class="us_container ">
        <div class="row">
          <div class="col-lg-6 col-md-6">
            <div class="box">
              <div class="img-box">
                <img src="images/u-1.png" alt="">
              </div>
              <div class="detail-box">
                <h5>
                  Imagen base
                </h5>
                <div class="btn-box">                  
                  <input type="file" id="upload" accept="image/*">
                </div>
                <p>
                  Ingresa la imagen base
                </p>
                <button class="btn btn-info" onclick="separarCanales()">Separar Canales RGB</button>
              </div>
            </div>
          </div>
          <div class="col-lg-6 col-md-6">
            <div class="box">
              <div class="img-box">
                <img src="images/u-4.png" alt="">
              </div>
              <div class="detail-box">
                <h5>                 
                    Kernel 3x3                  
                </h5>
                <div id="kernelContainer" class="kernel-inputs">
                    <div class="social_box_two">
                      <input type="number" style="width: 50px;" value="1"><input type="number" style="width: 50px;" value="0"><input type="number" style="width: 50px;" value="-1">
                    </div>
                    <div class="social_box_two">
                      <input type="number" style="width: 50px;" value="2"><input type="number" style="width: 50px;" value="0"><input type="number" style="width: 50px;" value="-2">
                    </div>
                    <div class="social_box_two">
                      <input type="number" style="width: 50px;" value="1"><input type="number" style="width: 50px;" value="0"><input type="number" style="width: 50px;" value="-1">
                    </div>                    
                </div>
                <br>
                <button class="btn btn-info" onclick="aplicarKernel()">Aplicar Kernel</button>

              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- end us section -->

  <!-- trainer section -->

  <section class="trainer_section layout_padding">
    <div class="container">
      
      <div class="row">
        <div class="col-lg-6 col-md-6 mx-auto">
          <div class="box">
            <div class="name">
              <h5>
                BASE
              </h5>
            </div>
            <div class="img-box">
              <img alt="">
                <canvas id="original"></canvas>
              </img>
            </div>
            <div class="social_box">
              <a href="#"></a>
              <a href="#">
                <img src="images/instagram-logo.png" alt="">
              </a>
              <a href="#"></a>
            </div>
          </div>
        </div>
        <div class="col-lg-6 col-md-6 mx-auto">
          <div class="box">
            <div class="name">
              <h5>
                CONVOLUCIÓN
              </h5>
            </div>
            <div class="img-box">
              <img alt="">
                <canvas id="processed"></canvas>
              </img>
            </div>
            <div class="social_box">
              <a href="#"></a>
              <a href="#">
                <img src="images/instagram-logo.png" alt="">
              </a>
              <a href="#"></a>
            </div>
          </div>
        </div>

        <div class="col-lg-4 col-md-6 mx-auto">
          <div class="box">
            <div class="name">
              <h5>
                RED
              </h5>
            </div>
            <div class="img-box">
              <img alt="">
                <canvas id="redChannel"></canvas>
              </img>
            </div>
            <div class="social_box">
              <a href="#"></a>
              <a href="#">
                <img src="images/instagram-logo.png" alt="">
              </a>
              <a href="#"></a>
            </div>
          </div>
        </div>

        <div class="col-lg-4 col-md-6 mx-auto">
          <div class="box">
            <div class="name">
              <h5>
                GREEN
              </h5>
            </div>
            <div class="img-box">
              <img alt="">
                <canvas id="greenChannel"></canvas>
              </img>
            </div>
            <div class="social_box">
              <a href="#"></a>
              <a href="#">
                <img src="images/instagram-logo.png" alt="">
              </a>
              <a href="#"></a>
            </div>
          </div>
        </div>

        <div class="col-lg-4 col-md-6 mx-auto">
          <div class="box">
            <div class="name">
              <h5>
                BLUE
              </h5>
            </div>
            <div class="img-box">
              <img alt="">
                <canvas id="blueChannel"></canvas>
              </img>
            </div>
            <div class="social_box">
              <a href="#"></a>
              <a href="#">
                <img src="images/instagram-logo.png" alt="">
              </a>
              <a href="#"></a>
            </div>
          </div>
        </div>


      </div>
    </div>
  </section>

  <!-- end trainer section -->

  <!-- info section -->
  <section class="info_section layout_padding2">
    <div class="container">
      <div class="info_items">
        <a href="#">
          <div class="item ">
            <div class="img-box box-1">
              <img src="" alt="">
            </div>
            <div class="detail-box">
              <p>
                Location
              </p>
            </div>
          </div>
        </a>
        <a href="#">
          <div class="item ">
            <div class="img-box box-2">
              <img src="" alt="">
            </div>
            <div class="detail-box">
              <p>
                +02 1234567890
              </p>
            </div>
          </div>
        </a>
        <a href="#">
          <div class="item ">
            <div class="img-box box-3">
              <img src="" alt="">
            </div>
            <div class="detail-box">
              <p>
                demo@gmail.com
              </p>
            </div>
          </div>
        </a>
      </div>
    </div>
  </section>

  <!-- end info_section -->

  <!-- footer section -->
  <footer class="container-fluid footer_section">
    <p>
      &copy; 2020 All Rights Reserved. Design by
      <a href="https://html.design/">Free Html Templates</a>
    </p>
  </footer>
  <!-- footer section -->
  <script>
    let image = new Image();
    document.getElementById('upload').addEventListener('change', function(event) {
        const file = event.target.files[0];
        if (file) {
            const reader = new FileReader();
            reader.onload = function(e) {
                image.src = e.target.result;
            };
            reader.readAsDataURL(file);
        }
    });

    image.onload = function() {
        const canvas = document.getElementById('original');
        const ctx = canvas.getContext('2d');
        canvas.width = 370;
        canvas.height = 397;
        ctx.drawImage(image, 0, 0, 370, 397);
    };

    function separarCanales() {
        const canvas = document.getElementById('original');
        const ctx = canvas.getContext('2d');
        const width = canvas.width, height = canvas.height;
        const imageData = ctx.getImageData(0, 0, width, height);
        const data = imageData.data;
        
        ['redChannel', 'greenChannel', 'blueChannel'].forEach((id, index) => {
            const channelCanvas = document.getElementById(id);
            const channelCtx = channelCanvas.getContext('2d');
            channelCanvas.width = width;
            channelCanvas.height = height;
            const channelData = channelCtx.createImageData(width, height);
            
            for (let i = 0; i < data.length; i += 4) {
                channelData.data[i] = index === 0 ? data[i] : 0; // Red
                channelData.data[i + 1] = index === 1 ? data[i + 1] : 0; // Green
                channelData.data[i + 2] = index === 2 ? data[i + 2] : 0; // Blue
                channelData.data[i + 3] = data[i + 3];
            }
            channelCtx.putImageData(channelData, 0, 0);
        });
    }

    function agregarInputs() {
        const container = document.getElementById('kernelContainer');
        container.innerHTML = '';
        for (let i = 0; i < 9; i++) {
            const input = document.createElement('input');
            input.type = 'number';
            input.value = '0';
            container.appendChild(input);
        }
    }

    function aplicarKernel() {
        const canvas = document.getElementById('original');
        const ctx = canvas.getContext('2d');
        const width = canvas.width, height = canvas.height;
        const imageData = ctx.getImageData(0, 0, width, height);
        const data = imageData.data;
        
        const kernelInputs = document.getElementById('kernelContainer').getElementsByTagName('input');
        const kernel = Array.from(kernelInputs).map(input => parseFloat(input.value));
        if (kernel.length !== 9) return;
        
        const outputCanvas = document.getElementById('processed');
        const outputCtx = outputCanvas.getContext('2d');
        outputCanvas.width = width;
        outputCanvas.height = height;
        const outputData = outputCtx.createImageData(width, height);
        
        for (let y = 1; y < height - 1; y++) {
            for (let x = 1; x < width - 1; x++) {
                let r = 0, g = 0, b = 0;
                for (let ky = -1; ky <= 1; ky++) {
                    for (let kx = -1; kx <= 1; kx++) {
                        const pixelIndex = ((y + ky) * width + (x + kx)) * 4;
                        const kernelValue = kernel[(ky + 1) * 3 + (kx + 1)];
                        r += data[pixelIndex] * kernelValue;
                        g += data[pixelIndex + 1] * kernelValue;
                        b += data[pixelIndex + 2] * kernelValue;
                    }
                }
                const outputIndex = (y * width + x) * 4;
                outputData.data[outputIndex] = Math.min(255, Math.max(0, r));
                outputData.data[outputIndex + 1] = Math.min(255, Math.max(0, g));
                outputData.data[outputIndex + 2] = Math.min(255, Math.max(0, b));
                outputData.data[outputIndex + 3] = 255;
            }
        }
        outputCtx.putImageData(outputData, 0, 0);
    }
  </script>
  <script src="js/jquery-3.4.1.min.js"></script>
  <script src="js/bootstrap.js"></script>

</body>

</html>
